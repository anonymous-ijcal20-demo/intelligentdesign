(function(e){function t(t){for(var i,a,l=t[0],c=t[1],h=t[2],u=t[3]||[],d=0,p=[];d<l.length;d++)a=l[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);f&&f(t),s.push.apply(s,u);while(p.length)p.shift()();return r.push.apply(r,h||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,a=1;a<n.length;a++){var h=n[a];0!==o[h]&&(i=!1)}i&&(r.splice(t--,1),e=c(c.s=n[0]))}return 0===r.length&&(s.forEach(function(e){if(void 0===o[e]){o[e]=null;var t=document.createElement("link");c.nc&&t.setAttribute("nonce",c.nc),t.rel="prefetch",t.as="script",t.href=l(e),document.head.appendChild(t)}}),s.length=0),e}var i={},a={app:0},o={app:0},r=[],s=[];function l(e){return c.p+"js/"+({"model-management":"model-management"}[e]||e)+"."+{"model-management":"bc7f2151"}[e]+".js"}function c(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"model-management":1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=new Promise(function(t,n){for(var i="css/"+({"model-management":"model-management"}[e]||e)+"."+{"model-management":"18c7d67f"}[e]+".css",o=c.p+i,r=document.getElementsByTagName("link"),s=0;s<r.length;s++){var l=r[s],h=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(h===i||h===o))return t()}var u=document.getElementsByTagName("style");for(s=0;s<u.length;s++){l=u[s],h=l.getAttribute("data-href");if(h===i||h===o)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var i=t&&t.target&&t.target.src||o,r=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");r.request=i,delete a[e],d.parentNode.removeChild(d),n(r)},d.href=o;var f=document.getElementsByTagName("head")[0];f.appendChild(d)}).then(function(){a[e]=0}));var i=o[e];if(0!==i)if(i)t.push(i[2]);else{var r=new Promise(function(t,n){i=o[e]=[t,n]});t.push(i[2]=r);var s,h=document.createElement("script");h.charset="utf-8",h.timeout=120,c.nc&&h.setAttribute("nonce",c.nc),h.src=l(e);var u=new Error;s=function(t){h.onerror=h.onload=null,clearTimeout(d);var n=o[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+a+")",u.name="ChunkLoadError",u.type=i,u.request=a,n[1](u)}o[e]=void 0}};var d=setTimeout(function(){s({type:"timeout",target:h})},12e4);h.onerror=h.onload=s,document.head.appendChild(h)}return Promise.all(t)},c.m=e,c.c=i,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)c.d(n,i,function(t){return e[t]}.bind(null,i));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var h=window["webpackJsonp"]=window["webpackJsonp"]||[],u=h.push.bind(h);h.push=t,h=h.slice();for(var d=0;d<h.length;d++)t(h[d]);var f=u,p=function(){return r.push([0,"chunk-vendors"]),n()}();t([[],{},0,["model-management"]])})({0:function(e,t,n){e.exports=n("56d7")},"1dca":function(e,t,n){},"2c8b":function(e,t,n){"use strict";var i=n("8a81"),a=n.n(i);a.a},"32f0":function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("bc3a"),a=n.n(i);function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){r(e,t,n[t])})}return e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function h(e){var t={model:[],fem:[],diff:[]};return e.forEach(function(e){t.model.push([e[0],e[1],e[2]]),t.fem.push([e[0],e[1],e[3]]),t.diff.push([e[0],e[1],Math.abs(e[2]-e[3])])}),t}var u=function(){function e(){s(this,e)}return c(e,null,[{key:"getModelResult",value:function(e){return a.a.post("/api/heatmap",o({},e)).then(function(e){return h(e.data.heatmap)},function(){return a.a.get("/mock/data.json").then(function(e){return h(e.data)})})}},{key:"getOnlineModel",value:function(){return a.a.get("/api/onLineModels").then(function(e){return e.data.onLineModel},function(){return a.a.get("/mock/on-line-models.json").then(function(e){return e.data})})}}]),e}()},"3bfd":function(e,t,n){"use strict";var i=n("cbac"),a=n.n(i);a.a},"3e8d":function(e,t,n){"use strict";var i=n("a8bd"),a=n.n(i);a.a},"458f":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("744f"),n("6c7b"),n("7514"),n("20d6"),n("1c4c"),n("6762"),n("cadf"),n("e804"),n("55dd"),n("d04f"),n("c8ce"),n("217b"),n("7f7f"),n("f400"),n("7f25"),n("536b"),n("d9ab"),n("f9ab"),n("32d7"),n("25c9"),n("9f3c"),n("042e"),n("c7c6"),n("f4ff"),n("049f"),n("7872"),n("a69f"),n("0b21"),n("6c1a"),n("c7c62"),n("84b4"),n("c5f6"),n("2e37"),n("fca0"),n("7cdf"),n("ee1d"),n("b1b1"),n("87f3"),n("9278"),n("5df2"),n("04ff"),n("f751"),n("4504"),n("fee7"),n("ffc1"),n("0d6d"),n("9986"),n("8e6e"),n("25db"),n("e4f7"),n("b9a1"),n("64d5"),n("9aea"),n("db97"),n("66c8"),n("57f0"),n("165b"),n("456d"),n("cf6a"),n("fd24"),n("8615"),n("551c"),n("097d"),n("df1b"),n("2397"),n("88ca"),n("ba16"),n("d185"),n("ebde"),n("2d34"),n("f6b3"),n("2251"),n("c698"),n("a19f"),n("9253"),n("9275"),n("3b2b"),n("3846"),n("4917"),n("a481"),n("28a5"),n("386d"),n("6b54"),n("4f7f"),n("8a815"),n("ac4d"),n("8449"),n("9c86"),n("fa83"),n("48c0"),n("a032"),n("aef6"),n("d263"),n("6c37"),n("9ec8"),n("5695"),n("2fdb"),n("d0b0"),n("5df3"),n("b54a"),n("f576"),n("ed50"),n("788d"),n("14b9"),n("f386"),n("f559"),n("1448"),n("673e"),n("242a"),n("c66f"),n("b05c"),n("34ef"),n("6aa2"),n("15ac"),n("af56"),n("b6e4"),n("9c29"),n("63d9"),n("4dda"),n("10ad"),n("c02b"),n("4795"),n("130f"),n("ac6a"),n("96cf");var i=n("bc3a"),a=n.n(i),o=n("2b0e"),r=n("5c96"),s=n.n(r),l=n("91d1");function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}var d="AUTH_TOKEN",f="USER_NAME",p=function(){function e(){c(this,e)}return u(e,null,[{key:"isLoggedIn",value:function(){return!!e.getAuthToken()}},{key:"getAuthToken",value:function(){return l["a"].getItem(d)}},{key:"getLoggedUserName",value:function(){return l["a"].getItem(f)}}]),e}(),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app"},[n("navigation"),n("router-view",{staticClass:"main-content"}),n("sn-footer")],1)},v=[],g=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},b=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("header",{staticClass:"row navigation"},[n("div",{staticClass:"grey"}),n("div",{staticClass:"text"},[e._v("智能设计优化平台v0.1")])])}],w={},y=w,C=(n("c98a"),n("2877")),x=Object(C["a"])(y,g,b,!1,null,"6a5af207",null);x.options.__file="Navigation.vue";var M=x.exports,_=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},k=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("footer",{staticClass:"row footer"},[n("div",{staticClass:"bg-footer"})])}],W={},E=W,D=(n("e37a"),Object(C["a"])(E,_,k,!1,null,"1b7cbe82",null));D.options.__file="SnFooter.vue";var P=D.exports,S={name:"App",components:{Navigation:M,SnFooter:P}},z=S,O=(n("5c0b"),Object(C["a"])(z,m,v,!1,null,null,null));O.options.__file="App.vue";var j=O.exports,L=n("8c4f"),T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",{staticClass:"row main"},[n("div",{staticClass:"settings-panel"},[n("normal-settings",{on:{change:e.onNormalSettingsChange}}),n("board-settings",{ref:"boardSetting",on:{change:e.onBoardSettingsChange,done:e.onBoardSettingsDone}}),n("div",{staticClass:"row operations"})],1),n("div",{staticClass:"result-panel"},[n("div",{staticClass:"row header"},[n("span",{staticClass:"result-text"},[e._v("运行结果")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.show3DChart,expression:"!show3DChart"}],staticClass:"diff-btn",attrs:{type:"primary",size:"small",round:"",disabled:!e.heatMap},on:{click:e.onDiffBtnClick}},[e._v("\n        生成对比结果\n      ")]),n("el-button",{staticClass:"switch-btn",attrs:{type:"primary",size:"small",round:"",disabled:!e.heatMap},on:{click:e.onSwithBtn}},[e._v("\n        "+e._s(e.swithBtnText)+"\n      ")])],1),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isModelLoading,expression:"isModelLoading"}],staticClass:"chart-panel",attrs:{"element-loading-text":e.modelLoadingText,"element-loading-background":"#080e14"}},[n("span",{staticClass:"title"},[e._v("模型预测结果热力图")]),e.heatMap&&e.show3DChart?n("bar-chart",{attrs:{data:e.heatMap.model}}):e._e(),e.heatMap&&!e.show3DChart?n("heatmap-chart",{staticClass:"twod-chart",attrs:{data:e.heatMap.model}}):e._e()],1),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isFemLoading,expression:"isFemLoading"}],staticClass:"chart-panel",attrs:{"element-loading-text":e.femLoadingText,"element-loading-background":"#080e14"}},[n("span",{staticClass:"title"},[e._v("有限元分析结果热力图")]),e.heatMap&&e.show3DChart?n("bar-chart",{attrs:{data:e.heatMap.fem}}):e._e(),e.heatMap&&!e.show3DChart?n("heatmap-chart",{staticClass:"twod-chart",attrs:{data:e.heatMap.fem}}):e._e()],1)]),n("el-dialog",{attrs:{visible:e.dialogVisible,"close-on-click-modal":!1,modal:!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?n("div",{staticClass:"chart-panel"},[n("span",{staticClass:"title"},[e._v("对比结果热力图")]),e.heatMap&&e.show3DChart?n("bar-chart",{attrs:{data:e.heatMap.diff}}):e._e(),e.heatMap&&!e.show3DChart?n("heatmap-chart",{staticClass:"twod-chart",attrs:{data:e.heatMap.diff}}):e._e()],1):e._e()])],1)},B=[],A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"chart",staticClass:"bar-chart"})},$=[],I=n("313e"),H=n.n(I);n("7cb2");function R(e){return F(e)||q(e)||N()}function N(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function q(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function F(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var G={props:{data:{type:Array,required:!0}},computed:{range:function(){var e=this.data.map(function(e){return e[2]});return{min:Math.min.apply(Math,R(e)),max:Math.max.apply(Math,R(e))}}},mounted:function(){var e=this,t=H.a.init(this.$refs.chart),n={xAxis3D:{type:"value"},yAxis3D:{type:"value"},zAxis3D:{type:"value",name:"",min:"dataMin",showMinLabel:!1},grid3D:{axisLine:{lineStyle:{color:"#fff"}},axisPointer:{lineStyle:{color:"#fff"}},viewControl:{},light:{main:{shadow:!0,quality:"ultra",intensity:1.5}}},visualMap:{show:!0,min:this.range.min,max:this.range.max,itemWidth:12,itemHeight:110,inRange:{color:["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffbf","#fee090","#fdae61","#f46d43","#d73027","#a50026"]}},series:[{type:"bar3D",data:this.data,shading:"lambert",label:{formatter:function(e){return e.value[2].toFixed(1)}}}]};t.setOption(n);var i=function(){return t.resize()},a=function(){return e.$emit("done")};t.on("finished",a),window.addEventListener("resize",i),this.$on("hook:beforeDestroy",function(){t.off("finished"),t.dispose(),window.removeEventListener("resize",i)})}},V=G,U=(n("3e8d"),Object(C["a"])(V,A,$,!1,null,"f21390ae",null));U.options.__file="BarChart.vue";var X=U.exports,Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"board-settings"})},J=[];function K(e,t){return ee(e)||Z(e,t)||Q()}function Q(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function Z(e,t){var n=[],i=!0,a=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0)if(n.push(r.value),t&&n.length===t)break}catch(l){a=!0,o=l}finally{try{i||null==s["return"]||s["return"]()}finally{if(a)throw o}}return n}function ee(e){if(Array.isArray(e))return e}function te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ie(e,t,n){return t&&ne(e.prototype,t),n&&ne(e,n),e}var ae=n("5a89"),oe=n("32d9"),re=oe.EffectComposer,se=n("4e15"),le=se.OutlinePass,ce=n("93e9"),he=ce.RenderPass,ue=n("23ee6"),de=ue.DragControls,fe=n("4721"),pe=fe.OrbitControls,me="#0f151c",ve="#1a2026",ge="#0f151c",be="#4a7386",we="#1a2b34",ye="#29bfff",Ce="#89dbff",xe="#29bfff",Me="#52575c",_e="#2b5162",ke=function(){function e(t){var n=this;te(this,e),this.container=t,this.width=this.container.clientWidth,this.height=this.container.clientHeight,this.changeHandler=null,this.raf=null,this.chessboardWidth=128,this.pieceWidth=10,this.hCellCount=10,this.vCellCount=10,this.gap=2,this.borderGap=5,this.chessContentWidth=(this.pieceWidth+this.gap)*this.vCellCount-this.gap,this.wallWidth=4,this.wallGap=2,this.pieceMoving=null,this.pieceMovingPos={x:0,y:0,z:0},this.mouseDownPos=new ae.Vector2,this.cells=[],this.pieces=[],this.scene=new ae.Scene,this.camera=new ae.OrthographicCamera(-this.width/2,this.width/2,this.height/2,-this.height/2,-1e3,1e3),this.renderer=new ae.WebGLRenderer({alpha:!0}),this.outlinePass=new le(new ae.Vector2(this.width,this.height),this.scene,this.camera),this.orbitControl=new pe(this.camera,this.renderer.domElement),this.walls={top:{show:!1,dirty:!0,pieces:[]},bottom:{show:!1,dirty:!0,pieces:[]},left:{show:!1,dirty:!0,pieces:[]},right:{show:!1,dirty:!0,pieces:[]}},this.wallHoles={top:[],bottom:[],left:[],right:[]},this.dragable=!1,this.renderer.setClearColor(new ae.Color(me)),this.camera.zoom=3,this.camera.position.x=0,this.camera.position.y=100,this.camera.position.z=0,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height),this.renderer.setPixelRatio(window.devicePixelRatio||1),this.container.appendChild(this.renderer.domElement);var i=new re(this.renderer),a=new he(this.scene,this.camera);i.addPass(a),this.outlinePass.edgeStrength=10,this.outlinePass.visibleEdgeColor.set("#fff"),this.outlinePass.hiddenEdgeColor.set("#190a05"),this.outlinePass.edgeGlow=0,this.outlinePass.edgeThickness=1,i.addPass(this.outlinePass);var o=new ae.GridHelper(1e3,50,new ae.Color(ve),new ae.Color(ve));this.scene.add(o);var r=new ae.BoxGeometry(this.chessboardWidth,4,this.chessboardWidth),s=new ae.MeshBasicMaterial({color:ge}),l=new ae.Mesh(r,s);l.position.x=0,l.position.y=0,l.position.z=0,this.scene.add(l);for(var c=0;c<this.hCellCount;c++)for(var h=0;h<this.vCellCount;h++){var u=new ae.PlaneGeometry(this.pieceWidth,this.pieceWidth),d=new ae.MeshBasicMaterial({color:be}),f=new ae.Mesh(u,d);f.userData.x1=this.borderGap+h*(this.pieceWidth+this.gap)-this.chessboardWidth/2,f.userData.x2=f.userData.x1+this.pieceWidth,f.userData.z1=this.borderGap+(this.vCellCount-1-c)*(this.pieceWidth+this.gap)-this.chessboardWidth/2,f.userData.z2=f.userData.z1+this.pieceWidth,f.userData.blank=!0,f.userData.pos=[h,c],f.rotateX(ae.Math.degToRad(-90)),f.position.x=f.userData.x1+this.pieceWidth/2,f.position.z=f.userData.z1+this.pieceWidth/2,f.position.y=2.1,this.scene.add(f),this.cells.push(f)}var p=new ae.FontLoader;p.load("/three/helvetiker_regular.typeface.json",function(e){for(var t,i,a=new ae.MeshBasicMaterial({color:Me}),o=[],r=0;r<n.cells.length;r+=n.hCellCount)i=n.cells[r],o.push({t:"".concat(r/n.hCellCount+1),x:i.userData.x1-18,y:i.position.y,z:i.position.z+2});for(var s,l="a".charCodeAt(0),c=0;c<n.hCellCount;c++)i=n.cells[c],o.push({t:"".concat(String.fromCharCode(l++)),x:i.position.x,y:i.position.y,z:i.userData.z2+14});o.forEach(function(i){t=new ae.TextGeometry(i.t,{font:e,size:4,height:1}),s=new ae.Mesh(t,a),s.position.x=i.x,s.position.y=i.y,s.position.z=i.z,s.rotateX(ae.Math.degToRad(-90)),n.scene.add(s)})});var m=function e(){n.raf=requestAnimationFrame(function(){e()}),i.render(),n.orbitControl.update()};m()}return ie(e,[{key:"_handleMousedown",value:function(e){this.mouseDownPos.x=e.clientX/this.width*2-1,this.mouseDownPos.y=-e.clientY/this.height*2+1;var t=new ae.Raycaster;t.setFromCamera(this.mouseDownPos,this.camera);var n=t.intersectObjects(this.scene.children);this.outlinePass.selectedObjects=[];for(var i=0;i<this.pieces.length;i++){for(var a=this.pieces[i].piece,o=!1,r=0;r<n.length;r++)a===n[r].object&&(a.material.color.set(xe),this.outlinePass.selectedObjects=[a],this.pieceMoving=a,this.pieceMovingPos.x=a.position.x,this.pieceMovingPos.z=a.position.z,o=!0);if(o)break;a.material.color.set(ye),this.pieceMoving=null}}},{key:"_getPositionByIndex",value:function(e,t){var n=this._getCellByIndex(e,t);return[n.position.x,n.position.z]}},{key:"_getCellByIndex",value:function(e,t){return this.cells[t*this.vCellCount+e]}},{key:"_buildWallPiece",value:function(e,t,n){var i=new ae.BoxGeometry(this.wallWidth,this.wallWidth,n),a=document.createElement("canvas");a.width=this.wallWidth,a.height=2*n;var o=a.getContext("2d");o.fillStyle=me,o.fillRect(0,0,this.wallWidth,n),o.fillStyle=_e;var r=0;while(r<2*n)o.fillRect(0,r,this.wallWidth,1),r+=2;for(var s=[],l=0;l<6;l++){var c=void 0;if(4===l||5===l){var h=a.cloneNode(!0),u=h.getContext("2d");u.fillStyle=me,u.fillRect(0,0,this.wallWidth,n),c=new ae.CanvasTexture(h)}else c=new ae.CanvasTexture(a),0!==l&&1!==l||(c.rotation=ae.Math.degToRad(-90));c.magFilter=ae.NearestFilter,c.minFilter=ae.NearestFilter,c.needsUpdate=!0;var d=new ae.MeshBasicMaterial({map:c});s.push(d)}var f,p,m=new ae.Mesh(i,s);"top"===e?(m.rotateY(ae.Math.degToRad(-90)),f=t+n/2,p=-this.chessContentWidth/2-this.wallWidth/2-this.wallGap):"bottom"===e?(m.rotateY(ae.Math.degToRad(-90)),f=t+n/2,p=this.chessContentWidth/2+this.wallWidth/2+this.wallGap):"left"===e?(f=-this.chessContentWidth/2-this.wallWidth/2-this.wallGap,p=-(t+n/2)):"right"===e&&(f=this.chessContentWidth/2+this.wallWidth/2+this.wallGap,p=-(t+n/2)),m.position.x=f,m.position.y=0,m.position.z=p,this.scene.add(m),this.walls[e].pieces.push(m)}},{key:"showWall",value:function(e){var t=this;if(e in this.walls){var n=this.walls[e];if(n.show=!0,n.dirty){n.pieces.forEach(function(e){t.scene.remove(e)}),n.pieces.length=0;var i,a,o,r=this.wallHoles[e];if(0===r.length)this._buildWallPiece(e,-this.chessContentWidth/2,this.chessContentWidth);else r.forEach(function(n,s){0===s&&n[0]>0&&(i=-t.chessContentWidth/2,a=(t.pieceWidth+t.gap)*n[0],t._buildWallPiece(e,i,a)),s!==r.length-1?(o=r[s+1],n[1]+1<o[0]&&(i=-t.chessContentWidth/2+(t.pieceWidth+t.gap)*(n[1]+1)-t.gap,a=(o[0]-n[1]-1)*(t.pieceWidth+t.gap)+t.gap,t._buildWallPiece(e,i,a))):n[1]<t.hCellCount-1&&(i=-t.chessContentWidth/2+(n[1]+1)*(t.pieceWidth+t.gap)-t.gap,a=(t.vCellCount-1-n[1])*(t.pieceWidth+t.gap),t._buildWallPiece(e,i,a))});n.dirty=!1}else this.walls[e].pieces.forEach(function(e){t.scene.add(e)})}else console.log("Invalid wall position")}},{key:"hideWall",value:function(e){var t=this;if(e in this.walls){var n=this.walls[e];n.show=!1,n.pieces.forEach(function(e){t.scene.remove(e)})}else console.log("Invalid wall position")}},{key:"addPiece",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=this._getCellByIndex(e,t);if(a)if(a.userData.blank){a.userData.blank=!1;var o=new ae.BoxGeometry(this.pieceWidth,this.pieceWidth,this.pieceWidth),r=new ae.MeshBasicMaterial({color:ye}),s=new ae.Mesh(o,r);s.userData.data=i,s.userData.pos=[e,t];var l=new ae.EdgesGeometry(o),c=new ae.LineSegments(l,new ae.LineBasicMaterial({color:Ce,linewidth:1})),h=this._getPositionByIndex(e,t),u=K(h,2),d=u[0],f=u[1];s.position.x=d,c.position.x=d,s.position.y=2.1+this.pieceWidth/2+1,c.position.y=s.position.y,s.position.z=f,c.position.z=f,this.scene.add(s),this.scene.add(c);var p=new de([s],this.camera,this.renderer.domElement);p.addEventListener("dragstart",function(e){var t=e.object;n.pieceMoving=t,n.pieceMovingPos={x:t.position.x,y:t.position.y,z:t.position.z}}),p.addEventListener("drag",function(e){var t=e.object.position;e.object.position.y=n.pieceMovingPos.y,c.position.x=t.x,c.position.y=n.pieceMovingPos.y,c.position.z=t.z,n.cells.forEach(function(e){var n=e.userData;t.x>=n.x1&&t.x<=n.x2&&t.z>=n.z1&&t.z<=n.z2?e.material.color.set(we):e.material.color.set(be)})}),p.addEventListener("dragend",function(e){for(var t=e.object,i=e.object.position,a=!1,o=0;o<n.cells.length;o++){var r=n.cells[o];r.material.color.set(be);var s=n.cells[o].userData;if(i.x>=s.x1&&i.x<=s.x2&&i.z>=s.z1&&i.z<=s.z2&&s.blank){t.position.x=r.position.x,t.position.y=n.pieceMovingPos.y,t.position.z=r.position.z,s.blank=!1;var l=K(t.userData.pos,2),h=l[0],u=l[1],d=n._getCellByIndex(h,u);d.userData.blank=!0,t.userData.pos=[s.pos[0],s.pos[1]],a=!0,n.changeHandler&&n.changeHandler({data:n.getData()})}}a||(t.position.x=n.pieceMovingPos.x,t.position.y=n.pieceMovingPos.y,t.position.z=n.pieceMovingPos.z),c.position.x=t.position.x,c.position.y=t.position.y,c.position.z=t.position.z,n.pieceMoving=null}),this.dragable||p.deactivate(),this.pieces.push({piece:s,moveControl:p}),this.changeHandler&&this.changeHandler({data:this.getData()})}else console.warn("The position is not blank");else console.warn("Invalid xIdx: ".concat(e,", yIdx: ").concat(t))}},{key:"enableDrag",value:function(){this.pieces.forEach(function(e){e.moveControl.activate()})}},{key:"disableDrag",value:function(){this.pieces.forEach(function(e){e.moveControl.deactivate()})}},{key:"enableOrbit",value:function(){this.orbitControl.enabled=!0}},{key:"disableOrbit",value:function(){this.orbitControl.enabled=!1}},{key:"zoom",value:function(e){this.camera.zoom+=e,this.camera.updateProjectionMatrix()}},{key:"resize",value:function(e,t){this.width=e,this.height=t,this.camera.left=-this.width/2,this.camera.right=this.width/2,this.camera.top=this.height/2,this.camera.bottom=-this.height/2,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}},{key:"digHole",value:function(e,t,n){if(e in this.wallHoles)if(t>n||t<0||n>this.hCellCount-1)console.log("Invalid hole index");else{var i=this.wallHoles[e];if(0===i.length)i.push([t,n]);else{for(var a,o=!0,r=0;r<i.length;r++){if(a=i[r],0===r&&n<=a[0]){i.unshift([t,n]),o=!1;break}if(t>=a[1]&&(r===i.length-1||n<=i[r+1][0])){i.splice(r+1,0,[t,n]),o=!1;break}}if(o)return void console.log("Invalid hole index")}var s=this.walls[e];s.dirty=!0,s.show&&this.showWall(e)}else console.log("Invalid wall position")}},{key:"blockHole",value:function(e,t){if(e in this.wallHoles){for(var n=this.wallHoles[e],i=0;i<n.length;i++)if(n[i][0]===t){n.splice(i,1);var a=this.walls[e];a.dirty=!0,a.show&&this.showWall(e);break}}else console.log("Invalid wall position")}},{key:"blockAllHoles",value:function(e){if(e in this.wallHoles){var t=this.wallHoles[e];if(t.length>0){t.length=0;var n=this.walls[e];n.dirty=!0,n.show&&this.showWall(e)}}else console.log("Invalid wall position")}},{key:"getData",value:function(){return this.pieces.map(function(e){var t=e.piece.userData;return{x:t.pos[0],y:t.pos[1],data:t.data}})}},{key:"destroy",value:function(){var e,t=this;null!==this.raf&&(window.cancelAnimationFrame(this.raf),this.raf=null),["top","bottom","left","right"].forEach(function(n){e=t.walls[n],e.show&&e.pieces.forEach(function(e){t.scene.remove(e)}),t.walls[n]=null,t.wallHoles[n].forEach(function(e){t.scene.remove(e)})}),this.pieces.forEach(function(e){e.moveControl.dispose()}),this.orbitControl.dispose(),this.scene.dispose()}}]),e}(),We={data:function(){return{count:10,board:null}},methods:{removeAllWalls:function(){this.board.hideWall("top"),this.board.hideWall("right"),this.board.hideWall("bottom"),this.board.hideWall("left")},buildAllWalls:function(){this.board.showWall("top"),this.board.showWall("right"),this.board.showWall("bottom"),this.board.showWall("left")}},mounted:function(){var e=this;if(this.board=new ke(this.$el),this.count>=100)throw new Error("Range Error: Count shoud be less than 100");this.board.changeHandler=function(t){var n=t.data,i=n.map(function(e){return[e.x,e.y]});e.$emit("change",i)};for(var t=0;t<this.count;++t)this.board.addPiece(t%10,Math.floor(t/10));this.board.disableOrbit(),this.board.enableDrag(),this.$emit("done"),this.$once("hook:beforeDestroy",function(){e.board.destroy()})}},Ee=We,De=(n("ceb9"),Object(C["a"])(Ee,Y,J,!1,null,"046ec048",null));De.options.__file="BoardSettings.vue";var Pe=De.exports,Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"normal-settings"},[n("div",{staticClass:"row setting"},[n("div",[n("div",{staticClass:"hint-text"},[e._v("数据与边界条件")]),n("multi-level-dropdown",{staticClass:"dropdown",on:{change:e.onBoundaryConditionChange}})],1),n("div",[n("div",{staticClass:"hint-text"},[e._v("方程约束")]),n("sn-select",{attrs:{items:e.equationList},on:{change:e.onEquationConstraintChange},model:{value:e.equationConstraint,callback:function(t){e.equationConstraint=t},expression:"equationConstraint"}})],1)]),n("div",{staticClass:"row setting"},[n("div",[n("div",{staticClass:"hint-text"},[e._v("模型列表")]),n("sn-select",{attrs:{items:e.modelList},on:{change:e.onModelChange},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1),n("el-button",{staticClass:"model-mgt-btn",attrs:{type:"primary",size:"small",round:""},on:{click:e.onModelManagementBtnClick}},[e._v("\n      模型管理\n    ")])],1)])},ze=[],Oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-menu",{staticClass:"multi-level-dropdown",attrs:{mode:"horizontal","menu-trigger":"hover","background-color":"#000000","text-color":"#ffffff","active-text-color":"#ffffff"},on:{select:e.handleSelect}},[n("el-submenu",{staticClass:"direct-sub",attrs:{index:"unique","popper-class":"multi-popper"}},[n("template",{slot:"title"},[n("span",{staticClass:"value"},[e._v(e._s(e.seletedValue))])]),e._l(e.items,function(t,i){return n("el-submenu",{key:i,attrs:{index:""+i}},[n("template",{slot:"title"},[e._v(e._s(t.name))]),e._l(t.values,function(t,i){return n("el-menu-item",{key:i,attrs:{index:""+i}},[e._v("\n        "+e._s(t)+"\n      ")])})],2)})],2)],1)},je=[],Le={data:function(){return{items:[{name:"蜂窝板",values:["全通风边界","单侧通风","单侧局部通风"]}],seletedValue:"蜂窝板;全通风边界"}},methods:{handleSelect:function(e,t){var n=this.items[t[1]];this.seletedValue="".concat(n.name,";").concat(n.values[t[2]]),this.$emit("change",this.seletedValue)}},mounted:function(){this.$emit("change",this.seletedValue)}},Te=Le,Be=(n("2c8b"),Object(C["a"])(Te,Oe,je,!1,null,null,null));Be.options.__file="MultiLevelDropdown.vue";var Ae=Be.exports,$e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-select",{staticClass:"sn-select",attrs:{size:"mini","popper-class":"sn-select-popper"},on:{change:e.onChange},model:{value:e.val,callback:function(t){e.val=t},expression:"val"}},e._l(e.items,function(e,t){return n("el-option",{key:t,attrs:{label:e,value:e}})}))},Ie=[],He={model:{prop:"value",event:"change"},props:{value:{type:String},items:{type:Array,default:function(){return[]}}},data:function(){return{val:""}},methods:{onChange:function(e){this.$emit("change",e)}},mounted:function(){this.val=this.value}},Re=He,Ne=(n("ae31"),n("6070"),Object(C["a"])(Re,$e,Ie,!1,null,"3312f2c0",null));Ne.options.__file="SnSelect.vue";var qe=Ne.exports,Fe={data:function(){return{boundaryCondition:"",equationConstraint:"泊松方程",model:"全通风ResNet",equationList:["泊松方程"],modelList:["全通风ResNet","单侧通风UNet","局部通风FPN"]}},methods:{onBoundaryConditionChange:function(e){this.boundaryCondition=e,this.triggerChangeEvent()},onEquationConstraintChange:function(){this.triggerChangeEvent()},onModelChange:function(){this.triggerChangeEvent()},onModelManagementBtnClick:function(){this.$router.push({name:"model-management"})},triggerChangeEvent:function(){this.$emit("change",{boundaryCondition:this.boundaryCondition,equationConstraint:this.equationConstraint,model:this.model})}},components:{MultiLevelDropdown:Ae,SnSelect:qe}},Ge=Fe,Ve=(n("3bfd"),Object(C["a"])(Ge,Se,ze,!1,null,"baf63d18",null));Ve.options.__file="NormalSettings.vue";var Ue=Ve.exports,Xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"heatmap",staticClass:"heatmap-chart"})},Ye=[];function Je(e){return Ze(e)||Qe(e)||Ke()}function Ke(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Qe(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function Ze(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var et={props:{data:{type:Array,required:!0}},computed:{range:function(){var e=this.data.map(function(e){return e[2]});return{min:Math.min.apply(Math,Je(e)),max:Math.max.apply(Math,Je(e))}},xData:function(){return this.data.map(function(e){return e[0]}).filter(function(e,t,n){return n.indexOf(e)===t})},yData:function(){return this.data.map(function(e){return e[1]}).filter(function(e,t,n){return n.indexOf(e)===t})}},mounted:function(){var e=this,t=H.a.init(this.$refs.heatmap),n={tooltip:{formatter:function(e){return e.data[2].toFixed(2)}},grid:{left:"center",width:300,height:300},xAxis:{type:"category",data:this.xData,axisLabel:{color:"rgba(255, 255, 255, 0.8)"}},yAxis:{type:"category",data:this.yData,axisLabel:{color:"rgba(255, 255, 255, 0.8)"}},visualMap:{show:!0,min:this.range.min,max:this.range.max,itemWidth:12,itemHeight:110,inRange:{color:["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffbf","#fee090","#fdae61","#f46d43","#d73027","#a50026"]}},series:[{type:"heatmap",data:this.data,progressive:1e3,animation:!1,itemStyle:{borderWidth:0,borderColor:"transparent",emphasis:{borderWidth:0}}}]};t.setOption(n);var i=function(){return t.resize()},a=function(){e.$emit("done")};t.on("finished",a),window.addEventListener("resize",i),this.$on("hook:beforeDestroy",function(){t.off("finished"),t.dispose(),window.removeEventListener("resize",i)})}},tt=et,nt=(n("f45d"),Object(C["a"])(tt,Xe,Ye,!1,null,"21f9de87",null));nt.options.__file="HeatmapChart.vue";var it=nt.exports,at=n("32f0"),ot={data:function(){return{heatMap:null,settings:null,grid:null,dialogVisible:!1,isModelLoading:!1,isFemLoading:!1,modelLoadingText:"Inference",femLoadingText:"数据预处理",timer:null,show3DChart:!1,swithBtnText:"切换至三维结果",isBoardSettingDone:!1}},methods:{onSwithBtn:function(){this.show3DChart=!this.show3DChart,this.show3DChart?this.swithBtnText="切换至二维结果":this.swithBtnText="切换至三维结果"},onBoardSettingsDone:function(){this.isBoardSettingDone=!0},onRunBtnClick:function(){var e=this;this.heatMap=null,this.show3DChart=!1,this.dialogVisible=!1,this.isModelLoading=!0,this.isFemLoading=!0,this.femLoadingText="数据预处理中";var t=this.setupLoadingText("数据预处理中"),n=at["a"].getModelResult(Object.assign({},this.settings,{grid:this.grid}));Promise.all([t,n]).then(function(t){e.isModelLoading=!1,e.heatMap=t[1],e.setupLoadingText("结果显示中").then(function(){return e.setupLoadingText("方程构建中")}).then(function(){return e.setupLoadingText("方程模拟中")}).then(function(){return e.setupLoadingText("结果显示中")}).then(function(){e.isFemLoading=!1})})},setupLoadingText:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return new Promise(function(i){setTimeout(function(){t.femLoadingText=e,i()},n)})},onBoardSettingsChange:function(e){var t=this;this.grid=e,this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){return t.onRunBtnClick()},3e3)},onNormalSettingsChange:function(e){if(this.settings=e,this.isBoardSettingDone){var t=this.settings.boundaryCondition;t.indexOf("全通风")>-1?this.$refs.boardSetting.removeAllWalls():t.indexOf("单侧通风")>-1?(this.$refs.boardSetting.buildAllWalls(),this.$refs.boardSetting.board.hideWall("left")):(this.$refs.boardSetting.board.blockHole("left",3,6),this.$refs.boardSetting.buildAllWalls(),this.$refs.boardSetting.board.digHole("left",3,6)),this.onBoardSettingsChange(this.grid)}},onDiffBtnClick:function(){this.dialogVisible=!0}},components:{BarChart:X,BoardSettings:Pe,NormalSettings:Ue,HeatmapChart:it}},rt=ot,st=(n("8393"),Object(C["a"])(rt,T,B,!1,null,"2049ebe4",null));st.options.__file="MainPage.vue";var lt=st.exports,ct=n("323e"),ht=n.n(ct);o["default"].use(L["a"]);var ut=new L["a"]({routes:[{path:"/",name:"main",component:lt},{path:"/model-management",name:"model-management",component:function(){return n.e("model-management").then(n.bind(null,"8fa4"))}}]});ut.beforeEach(function(e,t,n){e.matched.some(function(e){return e.meta.requiresAuth})?p.isLoggedIn()?(ht.a.start(),n()):n({path:"/login",query:{redirect:e.fullPath}}):(ht.a.start(),n())}),ut.afterEach(function(){ht.a.done()});var dt=ut;n("abe2");o["default"].use(s.a),o["default"].config.productionTip=!1,o["default"].prototype.$message=s.a.Message,a.a.interceptors.request.use(function(e){if(-1===e.url.indexOf("/api/login")){var t=p.getAuthToken();t&&(e.headers.Authorization=t)}return e}),a.a.interceptors.response.use(function(e){return e},function(e){if(401===e.response.status){var t=dt.currentRoute.fullPath;-1===t.indexOf("/login")&&dt.push({path:"/login",query:{redirect:t}})}return Promise.reject(e)}),window.eventBus=new o["default"],new o["default"]({router:dt,render:function(e){return e(j)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var i=n("458f"),a=n.n(i);a.a},6070:function(e,t,n){"use strict";var i=n("b828"),a=n.n(i);a.a},"79ca":function(e,t,n){},8393:function(e,t,n){"use strict";var i=n("f465"),a=n.n(i);a.a},"8a81":function(e,t,n){},"91d1":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",function(){return r});var r=function(){function e(){i(this,e)}return o(e,null,[{key:"available",value:function(){var e="test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}},{key:"getItem",value:function(t){return e.available()?localStorage.getItem(t):null}},{key:"setItem",value:function(t,n){e.available()&&localStorage.setItem(t,n)}},{key:"removeItem",value:function(t){e.available()&&localStorage.removeItem(t)}}]),e}()},a8bd:function(e,t,n){},abe2:function(e,t,n){},ae31:function(e,t,n){"use strict";var i=n("eba1"),a=n.n(i);a.a},b828:function(e,t,n){},c98a:function(e,t,n){"use strict";var i=n("ff89"),a=n.n(i);a.a},cbac:function(e,t,n){},ceb9:function(e,t,n){"use strict";var i=n("1dca"),a=n.n(i);a.a},d4be:function(e,t,n){},e37a:function(e,t,n){"use strict";var i=n("d4be"),a=n.n(i);a.a},eba1:function(e,t,n){},f45d:function(e,t,n){"use strict";var i=n("79ca"),a=n.n(i);a.a},f465:function(e,t,n){},ff89:function(e,t,n){}});
//# sourceMappingURL=app.4a6bddde.js.map